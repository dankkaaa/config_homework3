; ============================================================================
; ТЕСТОВЫЕ ПРОГРАММЫ ДЛЯ АССЕМБЛЕРА УВМ
; Этап 1: Перевод программы в промежуточное представление
; ============================================================================

; ============================================================================
; ТЕСТ 1: ПРОСТОЕ СЛОЖЕНИЕ
; Описание: Вычисление суммы двух чисел
; Входные данные: A=5, B=3
; Ожидаемый результат: A=8, сохранено по адресу 150
; ============================================================================

TEST1_SIMPLE_ADDITION:

; Инициализация регистров
LOAD A, 5       ; Загрузить 5 в регистр A
LOAD B, 3       ; Загрузить 3 в регистр B

; Выполнение операции сложения
ADD A, B        ; A = A + B = 8

; Сохранение результата
STORE A, 150    ; Сохранить результат в памяти по адресу 150

; Завершение программы
HALT            ; Остановка

; Ожидаемый машинный код (hex):
; 01 00 05 01 01 03 03 00 01 02 00 96 10
; Размер: 13 байт


; ============================================================================
; ТЕСТ 2: ЦИКЛИЧЕСКОЕ СУММИРОВАНИЕ
; Описание: Вычисление суммы 1+2+3+4+5 (треугольное число)
; Входные данные: B=5 (счётчик)
; Ожидаемый результат: A=15 (1+2+3+4+5)
; ============================================================================

TEST2_LOOP_SUM:

; Инициализация
LOAD A, 0       ; A = 0 (аккумулятор суммы)
LOAD B, 5       ; B = 5 (счётчик)

; Основной цикл суммирования
loop_sum:
ADD A, B        ; A = A + B (суммируем текущее значение счётчика)
SUB B, 1        ; B = B - 1 (уменьшаем счётчик)
JNZ loop_sum    ; Если B != 0, продолжить цикл

; Завершение
HALT            ; Остановка (A = 15)

; Ожидаемый машинный код (hex):
; 01 00 00 01 01 05 03 00 01 04 01 01 0a 06 04
; Размер: 15 байт


; ============================================================================
; ТЕСТ 3: УСЛОВНЫЙ ПЕРЕХОД (CMP и JZ)
; Описание: Условное выполнение в зависимости от результата сравнения
; Входные данные: A=5, B=5
; Ожидаемый результат: C=1 (они равны), D=0 (условие не выполняется)
; ============================================================================

TEST3_CONDITIONAL_JUMP:

; Загрузка значений
LOAD A, 5       ; A = 5
LOAD B, 5       ; B = 5

; Сравнение
CMP A, B        ; Сравниваем A и B (5 и 5)

; Условный прыжок
JZ equal_values ; Если A == B (результат сравнения = 0), прыгнуть на equal_values

; Путь если значения НЕ равны
LOAD C, 0       ; C = 0 (флаг: значения не равны)
JMP conditional_done

; Путь если значения РАВНЫ
equal_values:
LOAD C, 1       ; C = 1 (флаг: значения равны)

; Завершение
conditional_done:
HALT

; Ожидаемый машинный код (hex):
; 01 00 05 01 01 05 0b 00 01 09 07 01 02 00 08 0c 01 02 01 10
; Размер: 20 байт


; ============================================================================
; ТЕСТ 4: РАБОТА СО СТЕКОМ (PUSH и POP)
; Описание: Сохранение и восстановление значений из стека
; Входные данные: A=42, B=13
; Ожидаемый результат: Значения поменяны местами (A=13, B=42)
; ============================================================================

TEST4_STACK_OPERATIONS:

; Загрузка значений
LOAD A, 42      ; A = 42
LOAD B, 13      ; B = 13

; Сохранение в стек
PUSH A          ; Поместить A в стек (значение 42)
PUSH B          ; Поместить B в стек (значение 13)

; Восстановление в другом порядке
POP A           ; Извлечь из стека в A (теперь A = 13)
POP B           ; Извлечь из стека в B (теперь B = 42)

; После выполнения A и B поменялись местами
HALT

; Ожидаемый машинный код (hex):
; 01 00 2a 01 01 0d 0e 00 0e 01 0f 00 0f 01 10
; Размер: 15 байт


; ============================================================================
; ТЕСТ 5: ПРОИЗВЕДЕНИЕ ДВУХ ЧИСЕЛ (MUL и SUB)
; Описание: Вычисление произведения 4 * 7 = 28 через цикличное сложение
; Входные данные: A=4, B=7
; Ожидаемый результат: C=28 (4*7)
; ============================================================================

TEST5_MULTIPLICATION:

; Инициализация
LOAD A, 4       ; A = 4 (первый множитель/счётчик)
LOAD B, 7       ; B = 7 (второй множитель - что добавляем)
LOAD C, 0       ; C = 0 (результат)

; Умножение через цикл (повторяем добавление B, A раз)
mult_loop:
ADD C, B        ; C = C + B (добавляем B к результату)
SUB A, 1        ; A = A - 1 (уменьшаем счётчик)
JNZ mult_loop   ; Если A != 0, повторить

; После цикла C = 28
HALT

; Ожидаемый машинный код (hex):
; 01 00 04 01 01 07 01 02 00 03 02 01 04 00 01 0a 03
; Размер: 17 байт


; ============================================================================
; ТЕСТ 6: ВЛОЖЕННЫЕ УСЛОВИЯ (CMP, JZ, JNZ)
; Описание: Проверка нескольких условий
; Входные данные: A=10, B=10, C=20
; Логика: если A==B и A<C, то D=1, иначе D=0
; Ожидаемый результат: D=1 (оба условия верны)
; ============================================================================

TEST6_NESTED_CONDITIONS:

; Загрузка значений
LOAD A, 10      ; A = 10
LOAD B, 10      ; B = 10
LOAD C, 20      ; C = 20

; Первая проверка: A == B ?
CMP A, B        ; Сравниваем A и B
JNZ set_false   ; Если не равны, установить D=0 и выход

; Вторая проверка: A < C ? (A != C, и A < C)
CMP A, C        ; Сравниваем A и C
JZ set_false    ; Если равны, установить D=0 и выход

; Обе проверки пройдены
LOAD D, 1       ; D = 1 (оба условия верны)
JMP conditions_done

; Условие не выполнено
set_false:
LOAD D, 0       ; D = 0

conditions_done:
HALT

; Размер: ~24 байта


; ============================================================================
; ТЕСТ 7: ВЫЗОВ ПОДПРОГРАММЫ (CALL и RET)
; Описание: Вызов подпрограммы для сложения двух регистров
; Входные данные: A=5, B=3
; Ожидаемый результат: C=8 (результат работы подпрограммы)
; ============================================================================

TEST7_SUBROUTINE:

; Главная программа
LOAD A, 5       ; A = 5
LOAD B, 3       ; B = 3

; Вызов подпрограммы
CALL add_regs   ; Вызвать подпрограмму add_regs

; После возврата результат в C
HALT            ; Остановка

; Подпрограмма: сложение A и B, результат в C
add_regs:
LOAD C, 0       ; C = 0
ADD C, A        ; C = C + A
ADD C, B        ; C = C + B
RET             ; Возврат в главную программу

; Размер: ~16 байт


; ============================================================================
; ТЕСТ 8: ПРОСТОЕ ДЕЛЕНИЕ
; Описание: Деление одного числа на другое
; Входные данные: A=20, B=4
; Ожидаемый результат: C=5 (20/4)
; ============================================================================

TEST8_DIVISION:

; Инициализация
LOAD A, 20      ; A = 20 (делимое)
LOAD B, 4       ; B = 4 (делитель)
LOAD C, 0       ; C = 0 (результат)

; Деление через цикл вычитания
div_loop:
SUB A, B        ; A = A - B
ADD C, 1        ; Увеличиваем счётчик
CMP A, B        ; Проверяем, можем ли ещё вычесть
JNZ div_loop    ; Если A >= B, повторить

; После цикла C = 5 (количество вычитаний)
HALT

; Размер: ~18 байт


; ============================================================================
; ТЕСТ 9: ОСТАТОК ОТ ДЕЛЕНИЯ
; Описание: Вычисление остатка от деления
; Входные данные: A=17, B=5
; Ожидаемый результат: C=2 (17 mod 5)
; ============================================================================

TEST9_MODULO:

; Инициализация
LOAD A, 17      ; A = 17 (делимое)
LOAD B, 5       ; B = 5 (делитель)
LOAD C, 0       ; C = 0 (временная переменная)

; Цикл вычитания делителя
mod_loop:
CMP A, B        ; Сравниваем A и B
JZ mod_done     ; Если A < B, выход
SUB A, B        ; A = A - B
JMP mod_loop    ; Повторить цикл

; После цикла A содержит остаток (2)
mod_done:
HALT

; Размер: ~15 байт


; ============================================================================
; ВСЕ ТЕСТЫ ДЕМОНСТРИРУЮТ СЛЕДУЮЩИЕ ВОЗМОЖНОСТИ:
; ============================================================================
; ✓ Загрузку значений в регистры (LOAD)
; ✓ Сохранение значений в память (STORE)
; ✓ Арифметические операции (ADD, SUB, MUL)
; ✓ Деление и остаток (DIV, MOD)
; ✓ Сравнение и флаги (CMP)
; ✓ Условные переходы (JZ, JNZ)
; ✓ Безусловные переходы (JMP)
; ✓ Работу со стеком (PUSH, POP)
; ✓ Вызов подпрограмм (CALL, RET)
; ✓ Использование меток и циклов
; ✓ Корректную обработку синтаксиса и ошибок
; ✓ Вывод машинного кода в hex и dec форматах
; ✓ Работу с различными форматами чисел (decimal, hex)
; ============================================================================
